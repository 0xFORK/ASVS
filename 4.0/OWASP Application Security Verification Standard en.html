<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="section"></h1>
<p><img src="../images/OWASP_logo.png" alt="OWASP LOGO" /></p>
<h1 id="application-security-verification-standard-4.0">Application Security Verification Standard 4.0</h1>
<p>[date]</p>
<h1 id="frontispiece">Frontispiece</h1>
<h2 id="about-the-standard">About the Standard</h2>
<p>The Application Security Verification Standard is a list of application security requirements or tests that can be used by architects, developers, testers, security professionals, and even consumers to define what a secure application is.</p>
<h2 id="copyright-and-license">Copyright and License</h2>
<p><img src="../images/license.png" alt="license" /><br />
Copyright © 2017 The OWASP Foundation. This document is released under the Creative Commons Attribution ShareAlike 3.0 license. For any reuse or distribution, you must make clear to others the license terms of this work.</p>
<h2 id="draft-version">Draft Version</h2>
<p>This is a draft version of the standard, and as such should not be used until released. If you find any issues within the standard that should be addressed:</p>
<ul>
<li>Design of the standard.</li>
<li>Missing controls.</li>
<li>Ineffective or outdated controls.</li>
<li>Unclear wording, spelling, grammar issues.</li>
<li>Formatting issues.</li>
<li>Translation issues – if a control’s wording is such that trying express it in your language will be difficult or impossible, please let us know. If it doesn’t work in Spanish or Thai, it probably isn’t working in English either.</li>
<li>Offers of translation – please let us know so that we can direct you to folks already working on your language.</li>
</ul>
<p>Please log an issue here: <a href="https://github.com/OWASP/ASVS/issues" class="uri">https://github.com/OWASP/ASVS/issues</a></p>
<p>Version 4.0, 2018<br />
| Project Leads | Lead Authors | Contributors and Reviewers |<br />
| --- | --- | --- |<br />
| Andrew van der Stock, Daniel Cuthbert | Jim Manico | Boy Baukema, Chris Bradley, Dr Daniël Geerts |</p>
<h1 id="preface">Preface</h1>
<p>Welcome to the Application Security Verification Standard (ASVS) version 4.0. The ASVS is a community-effort to establish a framework of security requirements and controls that focus on normalizing the functional and non-functional security controls required when designing, developing and testing modern web applications.</p>
<p>ASVS v4.0 is a culmination of community effort and industry feedback. In this release, we felt it was important to qualify the experiences of real world use cases relating to ASVS adoption. This will help newcomers to the standard plan their adoption of the ASVS, whilst assisting existing companies in learning from the experience of others.</p>
<p>We expect that there will most likely never be 100% agreement on this standard. Risk analysis is always subjective to some extent, which creates a challenge when attempting to generalize in a one size fits all standard. However, we hope that the latest updates made in this version are a step in the right direction, and respectfully enhance the concepts introduced in this important industry standard.</p>
<h2 id="whats-new-in-4.0">What’s new in 4.0</h2>
<p>The single largest change in this version is the adoption of NIST 800-63, concentrating on introducing controls at authentication assurance levels 1 through 3. Although we do expect there to be some pushback on this adoption, it's important for standards to be aligned, particularly when a newer standard is evidence based.</p>
<p>We have worked to comprehensively meet and exceed OWASP Top 10 2017 requirements. As the OWASP Top 10 2017 is the bare minimum to avoid negligence, we have deliberately set nearly all of OWASP Top 10 controls to be L1. This makes it easier for OWASP Top 10 adopters to continuously improve, especially when they want to continue the security journey by building in security into every application and API.</p>
<p>We have completed the shift of the ASVS from monolithic server side only controls, to providing solid controls for all modern applications and APIs. In the days of functional programming, server less API, mobile, cloud, IoT, CI/CD and DevOps, and federation, we cannot keep on ignoring modern application architecture. Modern applications are designed differently to those in 2008, when the original ASVS was written. The ASVS must always look far into the future so that we provide sound advice for our primary audience - developers. We have clarified or dropped any requirement that assumes that security must be solely performed on a server owned by a single organization.</p>
<p>We have retired the mobile section, in favor of the Mobile Application Security Verification Standard (MASVS) and the Internet of Things section in favour of the OWASP Internet of Things Projects. Our aim is to support them as much as possible, by being a reference where needed. As that standard does not particularly strongly elucidate API security issues, we have decided to concentrate on being the best standard for web apps and all forms of API - RESTful and SOAP web services, monolithic or micro services. Mobile application developers should see the MASVS as being highly useful for mobile client issues, and the ASVS as being highly useful for mobile APIs and micro services.</p>
<p>Lastly, we have de-duped and retired controls that cannot get you hacked. Over time, the ASVS started being a comprehensive set of controls, but not all controls are equal at producing secure software. We have re-validated L1 to be a &quot;Core&quot; or &quot;Essential&quot; control set, by setting a CVSS score bar of 7.5 or above to be in L1. This helps compliant organizations adhere to PCI DSS's requirements to resolve all High and Critical findings rapidly. If an application or API has a failed L1 control, it is a serious risk to any organization.</p>
<h1 id="using-the-asvs">Using the ASVS</h1>
<p>ASVS has two main goals:</p>
<ul>
<li>to help organizations develop and maintain secure applications.</li>
<li>to allow security service, security tools vendors, and consumers to align their requirements and offerings.</li>
</ul>
<p>Application Security Verification Levels<br />
The Application Security Verification Standard defines three security verification levels, with each level increasing in depth.</p>
<ul>
<li>ASVS Level 1 is meant for all software.</li>
<li>ASVS Level 2 is for applications that contain sensitive data, which requires protection.</li>
<li>ASVS Level 3 is for the most critical applications - applications that perform high value transactions, contain sensitive medical data, or any application that requires the highest level of trust.</li>
</ul>
<p>Each ASVS level contains a list of security requirements. Each of these requirements can also be mapped to security-specific features and capabilities that must be built into software by developers.</p>
<p>Figure 1 - OWASP Application Security Verification Standard 4.0 Levels</p>
<h2 id="how-to-use-this-standard">How to use this standard</h2>
<p>One of the best ways to use the Application Security Verification Standard is to use it as blueprint create a Secure Coding Checklist specific to your application, platform or organization. Tailoring the ASVS to your use cases will increase the focus on the security requirements that are most important to your projects and environments.</p>
<h3 id="level-1-opportunistic">Level 1: Opportunistic</h3>
<p>An application achieves ASVS Level 1 (or Opportunistic) if it adequately defends against application security vulnerabilities that are easy to discover, and included in the OWASP Top 10 and other similar checklists.</p>
<p>Level 1 is typically appropriate for applications where low confidence in the correct use of security controls is required, or to provide a quick analysis of a fleet of enterprise applications, or assisting in developing a prioritized list of security requirements as part of a multi-phase effort. Level 1 controls can be ensured either automatically by tools or simply manually without access to source code. We consider Level 1 the minimum required for all applications.</p>
<p>Threats to the application will most likely be from attackers who are using simple and low effort techniques to identify easy-to-find and easy-to-exploit vulnerabilities. This is in contrast to a determined attacker who will spend focused energy to specifically target the application. If data processed by your application has high value, you would rarely want to stop at a Level 1 review.</p>
<h3 id="level-2-standard">Level 2: Standard</h3>
<p>An application achieves ASVS Level 2 (or Standard) if it adequately defends against most of the risks associated with software today.</p>
<p>Level 2 ensures that security controls are in place, effective, and used within the application. Level 2 is typically appropriate for applications that handle significant business-to-business transactions, including those that process healthcare information, implement business-critical or sensitive functions, or process other sensitive assets.</p>
<p>Threats to Level 2 applications will typically be skilled and motivated attackers focusing on specific targets using tools and techniques that are highly practiced and effective at discovering and exploiting weaknesses within applications.</p>
<h3 id="level-3-advanced">Level 3: Advanced</h3>
<p>ASVS Level 3 is the highest level of verification within the ASVS. This level is typically reserved for applications that require significant levels of security verification, such as those that may be found within areas of military, health and safety, critical infrastructure, etc.</p>
<p>Organizations may require ASVS Level 3 for applications that perform critical functions, where failure could significantly impact the organization's operations, and even its survivability. Example guidance on the application of ASVS Level 3 is provided below. An application achieves ASVS Level 3 (or Advanced) if it adequately defends against advanced application security vulnerabilities and also demonstrates principles of good security design.</p>
<p>An application at ASVS Level 3 requires more in depth analysis, architecture, coding, and testing than all the other levels. A secure application is modularized in a meaningful way (to facilitate e.g. resiliency, scalability, and most of all, layers of security), and each module (separated by network connection and/or physical instance) takes care of its own security responsibilities (defense in depth), that need to be properly documented. Responsibilities include controls for ensuring confidentiality (e.g. encryption), integrity (e.g. transactions, input validation), availability (e.g. handling load gracefully), authentication (including between systems), non-repudiation, authorization, and auditing (logging).</p>
<h2 id="applying-asvs-in-practice">Applying ASVS in Practice</h2>
<p>Different threats have different motivations. Some industries have unique information and technology assets and domain specific regulatory compliance requirements.</p>
<p>Below we provide industry-specific guidance regarding recommended ASVS levels. Although some unique criteria and some differences in threats exist for each industry, a common theme throughout all industry segments is that opportunistic attackers will look for any easily exploitable vulnerable applications, which is why ASVS Level 1 is recommended for all applications regardless of industry. This is a suggested starting point to manage the easiest to find risks.</p>
<p>Organizations are strongly encouraged to look more deeply at their unique risk characteristics based on the nature of their business. At the other end of the spectrum is ASVS Level 3, which is reserved for those cases that might endanger human safety or when a full application breach could severely impact the organization.</p>
<p>TBD - Need to re-do case studies / applicability.</p>
<h1 id="assessment-and-certification">Assessment and Certification</h1>
<h2 id="owasps-stance-on-asvs-certifications-and-trust-marks">OWASP's Stance on ASVS Certifications and Trust Marks</h2>
<p>OWASP, as a vendor-neutral not-for-profit organization, does not currently certify any vendors, verifiers or software.</p>
<p>All such assurance assertions, trust marks, or certifications are not officially vetted, registered, or certified by OWASP, so an organization relying upon such a view needs to be cautious of the trust placed in any third party or trust mark claiming ASVS certification.</p>
<p>This should not inhibit organizations from offering such assurance services, as long as they do not claim official OWASP certification.</p>
<h2 id="guidance-for-certifying-organizations">Guidance for Certifying Organizations</h2>
<p>The Application Security Verification Standard can be used as an open book verification of the application, including open and unfettered access to key resources such as architects and developers, project documentation, source code, authenticated access to test systems (including access to at least one account in each role), particularly for L2 and L3 verifications.</p>
<p>Historically, penetration testing and secure code reviews have included issues “by exception” - that is only failed issues appear in the final report. A certifying organization must include in any report the scope of the verification (particularly if a key component is out of scope, such as SSO authentication), a summary of verification findings, including passed and failed tests, with clear indications of how to resolve the failed tests.</p>
<p>Keeping detailed work papers, screenshots or movies, scripts to reliably and repeatedly exploit an issue, and electronic records of testing, such as intercepting proxy logs and associated notes such as a cleanup list, is considered standard industry practice and can be really useful as proofs of the findings for the most doubts developers. It is not sufficient to simply run a tool and report on the failures; this does not (at all) provide sufficient evidence that all issues at a certifying level have been tested and tested thoroughly. In case of dispute, there should be sufficient assurance evidence to demonstrate each and every verified requirement has indeed been tested.</p>
<h3 id="the-role-of-automated-security-testing-tools">The Role of Automated Security Testing Tools</h3>
<p>Automated penetration tools are encouraged to provide as much as possible coverage and to exercise as many parameters as possible with many different forms of malicious inputs as possible.</p>
<p>It is not possible to fully complete ASVS verification using automated penetration testing tools alone. Whilst a large majority of requirements in L1 can be performed using automated tests, the overall majority of requirements are not amenable to automated penetration testing.</p>
<p>Please note that the lines between automated and manual testing have blurred as the application security industry matures. Automated tools are often manually tuned by experts and manual testers often leverage a wide variety of automated tools.</p>
<h2 id="the-role-of-penetration-testing">The Role of Penetration Testing</h2>
<p>It is possible to perform a manual penetration test and verify all L1 issues without requiring access to source code, but this is not a leading practice. L2 requires at least some access to developers, documentation, code, and authenticated access to the system. Complete penetration testing coverage at Level 3 is not possible, as most of the additional issues involve review of system configuration, malicious code review, threat modeling, and other non-penetration testing artifacts.</p>
<h3 id="as-detailed-security-architecture-guidance">As Detailed Security Architecture Guidance</h3>
<p>One of the more common uses for the Application Security Verification Standard is as a resource for security architects. The two major security architecture frameworks, SABSA or TOGAF, are missing a great deal of information that is necessary to complete application security architecture review. ASVS can be used to fill in those gaps by allowing security architects to choose better controls for common problems, such as data protection patterns and input validation strategies.</p>
<h3 id="as-a-replacement-for-off-the-shelf-secure-coding-checklists">As a Replacement for Off-the-shelf Secure Coding Checklists</h3>
<p>Many organizations can benefit from adopting the ASVS, by choosing one of the three levels, or by forking ASVS and changing what is required for each application risk level in a domain specific way. We encourage this type of forking as long as traceability is maintained, so that if an app has passed requirement 4.1, this means the same thing for forked copies as the standard as it evolves.</p>
<h3 id="as-a-guide-for-automated-unit-and-integration-tests">As a Guide for Automated Unit and Integration Tests</h3>
<p>The ASVS is designed to highly testable, with the sole exception of architectural and malicious code requirements. By building unit and integration tests that test for specific and relevant fuzz and abuse cases, the application becomes nearly self-verifying with each and every build. For example, additional tests can be crafted for the test suite for a login controller, testing the username parameter for common usernames, account enumeration, brute forcing, LDAP and SQL injection, and XSS. Similarly, a test on the password parameter should include common passwords, password length, null byte injection, removing the parameter, XSS, account enumeration, and more.</p>
<h3 id="for-secure-development-training">For Secure Development Training</h3>
<p>ASVS can also be used to define characteristics of secure software. Many “secure coding” courses are simply ethical hacking courses with a light smear of coding tips. This does not help developers. Instead, secure development courses can use the ASVS with a strong focus on the proactive controls found in the ASVS, rather than the Top 10 negative things not to do.</p>
<h1 id="v1-architecture-design-and-threat-modeling-requirements">V1: Architecture, Design and Threat Modeling Requirements</h1>
<h2 id="control-objective">Control Objective</h2>
<p>In a perfect world, security would be considered throughout all phases of development. In reality however, security is often only a consideration at a late stage in the SDLC. Besides the technical controls, the ASVS requires processes to be in place that ensure that the security has been explicitly addressed when planning the architecture of the application or API, and that the functional and security roles of all components are known. Since single page applications and act as clients to remote API or services, it must be ensured that appropriate security standards are also applied to those services - testing the app in isolation is not sufficient.</p>
<p>The category “V1” lists requirements pertaining to architecture and design of the app. As such, this is the only category that does not map to technical test cases in the OWASP Testing Guide. To cover topics such as threat modeling, secure SDLC, key management, users of the ASVS should consult the respective OWASP projects and/or other standards such as the ones linked below.</p>
<h2 id="security-verification-requirements">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>1.1</strong></td>
<td style="text-align: left;">All app components are identified and known to be needed.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>1.2</strong></td>
<td style="text-align: left;">Security controls are never enforced only on the client side, but on the respective remote endpoints.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>1.3</strong></td>
<td style="text-align: left;">A high-level architecture for the application and all connected remote services has been defined and security has been addressed in that architecture.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>1.4</strong></td>
<td style="text-align: left;">Data considered sensitive in the context of the application is clearly identified.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>1.5</strong></td>
<td style="text-align: left;">All app components are defined in terms of the business functions and/or security functions they provide.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>1.6</strong></td>
<td style="text-align: left;">A threat model for the application and the associated remote services has been produced that identifies potential threats and countermeasures.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>1.7</strong></td>
<td style="text-align: left;">All security controls have a centralized implementation as to avoid duplication of critical code.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>1.8</strong></td>
<td style="text-align: left;">Components are segregated from each other via a defined security control, such as network segmentation, firewall rules, or cloud based security groups.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>1.9</strong></td>
<td style="text-align: left;">A mechanism for enforcing updates of the application exists.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>1.10</strong></td>
<td style="text-align: left;">Security is addressed within all parts of the software development lifecycle.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>1.11</strong></td>
<td style="text-align: left;">All application components, libraries, modules, frameworks, platform, and operating systems are free from known vulnerabilities.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>1.12</strong></td>
<td style="text-align: left;">There is an explicit policy for how cryptographic keys (if any) are managed, and the lifecycle of cryptographic keys is enforced. Ideally, follow a key management standard such as NIST SP 800-57.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h2 id="references">References</h2>
<p>For more information, see also:</p>
<p>For more information, please see:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Application_Security_Architecture_Cheat_Sheet">OWASP Threat Modeling Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Attack_Surface_Analysis_Cheat_Sheet">OWASP Attack Surface Analysis Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Application_Security_Architecture_Cheat_Sheet">OWASP Security Architecture Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Application_Threat_Modeling">OWASP Threat modelling</a></li>
<li><a href="https://www.owasp.org/index.php/Secure_SDLC_Cheat_Sheet">OWASP Secure SDLC Cheat Sheet</a></li>
<li><a href="https://www.microsoft.com/en-us/sdl/">Microsoft SDL</a></li>
<li><a href="http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57-Part1-revised2_Mar08-2007.pdf">NIST SP 800-57</a></li>
</ul>
<h1 id="v2-authentication-verification-requirements">V2: Authentication Verification Requirements</h1>
<h2 id="control-objective-1">Control Objective</h2>
<p>Authentication is the act of establishing, or confirming, something (or someone) as authentic, that is, that claims made by a person or about a device are true, resistant to impersonation (phishing), and prevents recovery or interception of memorized secrets (passwords).</p>
<p>ASVS V2 Authentication, V3 Session Management, and V4 Access Controls have been adapted to be a compliant subset of selected NIST 800-63 controls, focused around typical threats and commonly exploited authentication weaknesses. Previous verification requirements have been retired, de-duped, or in most cases adapted to either be identical or strongly aligned with the intent of NIST 800-63 normative (mandatory) requirements. Logging requirements have been moved to the V8 Error and Logging chapter. TLS requirements have been moved to the V10 Communications Chapter.</p>
<p>NIST 800-63 is a modern, evidence based standard, and represents the best advice available, regardless of applicabilty. The standard is helpful for all organizations all over the world, but is particularly relevant to US agencies and those dealing with US agencies.</p>
<p>Implementers requiring the full set of controls should review the entire standard, especially regarding evidence of identity, identity binding, identity assertion, the deployment and management of multi-factor, biometric and crypto devices, security usability, and a great deal more advanced topics. Full compliance with the ASVS 4.0 is not the same as full compliance with NIST 800-63.</p>
<h3 id="selecting-an-appropriate-nist-aal-level">Selecting an appropriate NIST AAL Level</h3>
<p>The Application Security Verification Standard has mapped ASVS L1 to AAL1 requirements, L2 to AAL2, and L3 to AAL3. However, the approach of ASVS Level 1 as &quot;essential&quot; controls may not necessarily be the correct AAL level to verify an application or API. For example, if the application is a Level 3 application or has regulatory requirements to be AAL3, Level 3 should be chosen in Sections V2 and V3 Session Management.</p>
<p>The choice of NIST compliant authentication assertion level (AAL) should be performed as per NIST 800-63 guidelines as set out in <em>Selecting AAL</em> in <a href="https://pages.nist.gov/800-63-3/sp800-63-3.html#AAL_CYOA">NIST 800-63 Section 6.2</a>.</p>
<p>We strongly urge everyone to adopt NIST 800-63, and align any policies, guidelines and standards with it, such as we've done here.</p>
<h2 id="authentication-verification-requirements">Authentication Verification Requirements</h2>
<p>Legend</p>
<p>Applications can always exceed the current level's requirements. To assist in establishing a baseline, the following is used throughout the standard:</p>
<ul>
<li>No check tick or &quot;o&quot; - not required at this level</li>
<li>&quot;o&quot; - recommended, but not required</li>
<li>&quot;✓&quot; - required</li>
</ul>
<h3 id="v2.1-general-authenticator-requirements">V2.1 General Authenticator Requirements</h3>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>2.1.1</strong></td>
<td style="text-align: left;">Verify physical authenticators can be suspended or revoked, and this is effective including through Identity Providers and Relying Parties (RPs).</td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.1.2</strong></td>
<td style="text-align: left;">Verify one or more of anti-automation, rate limiting, CAPTCHA, increasing delays, IP address restrictions, risk-based restrictions, is in place and effective to prevent breached credential testing, brute forcing, and account lockout attacks. Verify that no more than 100 failed attempts is possible on a single account.</td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.2.2 / 5.1.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.1.3</strong></td>
<td style="text-align: left;">Verify biometric authenticators are used as one factor of multi-factor authentication in conjunction with an other factor of either something you have and/or something you know.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.1.4</strong></td>
<td style="text-align: left;">Verify attestation information is available. For more information, please see NIST 800-63 B § 5.2.4</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.2.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.1.5</strong></td>
<td style="text-align: left;">Verify impersonation resistance against phishing is in place, such as the use of client-side certificates.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.2.5</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.1.6</strong></td>
<td style="text-align: left;">Verify where a verifier and CSP are separate, mutually authenticated TLS must be in place between the verifier and the CSP.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.2.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.1.7</strong></td>
<td style="text-align: left;">Verify verifier compromise resistance by ensuring sufficient strength of approved public key cryptographic algorithms as per standards such as NIST 800-131A or similar.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.2.7</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.1.8</strong></td>
<td style="text-align: left;">Verify replay resistance is present, such as the mandated use of OTP devices, cryptographic authenticators, or lookup codes.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.2.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.1.9</strong></td>
<td style="text-align: left;">Verify authentication intent by the entry of an OTP token in authentication or high value re-authentication flows, or user initiated action resulting in cryptographic device authentication, such as a button press on a FIDO hardware key.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.2.9</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.1.10</strong></td>
<td style="text-align: left;">Verify restricted authenticators - such as email and SMS - are not a preferred recovery mechanism or second factor, and at least one alternative is offered to the user first. If the user selects a restricted authenticator, a meaningful warning covering the potential risks of that restricted authenticator SHOULD be presented to the user, including that the future use of the restricted authenticator may be removed in the future.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.2.10</td>
</tr>
</tbody>
</table>
<p>In the future, email and SMS restricted authenticators will be removed from NIST 800-63 and thus the ASVS, so they should not be the sole form of credential recovery or second factor authenticator. (Introduce concept of authenticator agility?)</p>
<h3 id="v2.2-authenticator-lifecycle-requirements">V2.2 Authenticator Lifecycle Requirements</h3>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>2.2.1</strong></td>
<td style="text-align: left;">Verify generated memorized secret initial values or activation codes SHOULD be securely randomly generated, SHOULD be at least 6 characters long, and MAY contain letters and numbers.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2 / A.3</td>
</tr>
</tbody>
</table>
<h3 id="v2.3-authenticator-recovery-requirements">V2.3 Authenticator Recovery Requirements</h3>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>2.3.1</strong></td>
<td style="text-align: left;">Verify memorized secret credential recovery does not reveal the current memorized secret and that a system generated new memorized secret is not sent in clear text to the user. Lookup codes or a random, time limited one time reset link should be used instead.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.3.1</strong></td>
<td style="text-align: left;">Verify memorized secret hints or knowledge based answers (so called &quot;secret questions&quot;) are not present.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.3.2</strong></td>
<td style="text-align: left;">Verify memorized secret credential recovery does not reveal the current memorized secret in any way.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.3.4</strong></td>
<td style="text-align: left;">Verify forgotten memorized secret and other recovery paths use a TOTP or other soft token, mobile push, or other offline recovery mechanism. The use of email or PSTN verifiers (such as SMS tokens) has been deprecated by NIST and SHOULD NOT be used.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.3.5</strong></td>
<td style="text-align: left;">Verify identities cannot cannot be re-bound to a different identity (spoofing).</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2 / A.3</td>
</tr>
</tbody>
</table>
<h3 id="v2.4-memorized-secrets-authenticator-requirements">V2.4 Memorized Secrets Authenticator Requirements</h3>
<p>Memorized secrets are passwords, PINs, unlock patterns, pick the correct kitten or other image element, and passphrases. They are generally considered &quot;something you know&quot;, and often used as single factor authenticators. There are signficant challenges to continued use of single factor authentication, including billions of valid usernames and passwords disclosed on the Internet, default or weak passwords, rainbow tables and ordered dictionaries of the most common passwords.</p>
<p>Memorizd secrets alone are simply not sufficient. The ASVS (since 3.0) requires multi-factor authentication in addition to memorized secrets. We have not relaxed this point of view. NIST 800-63 recommends but does not require multi-factor authentication at IAL1/AAL1, but we feel strongly that it is important to start the process of universal multi-factor authentication, as it defeats the most common attacks against passwords. Therefore, we have set multi-factor authentication as a baseline L1 requirement.</p>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>2.4.1</strong></td>
<td style="text-align: left;">Verify that memorized secrets are at least 8 characters in length.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.4.2</strong></td>
<td style="text-align: left;">Verify that memorized secrets 64 characters or longer are permitted.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.4.3</strong></td>
<td style="text-align: left;">Verify that memorized secrets can contain spaces and truncation is not performed. Consecutive multiple spaces MAY optionally be coalesced.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.4.4</strong></td>
<td style="text-align: left;">Verify that Unicode characters are permitted in memorized secrets. A single Unicode code point is considered a character, so 8 emoji or 64 kanji characters should be valid and permitted.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.4.5</strong></td>
<td style="text-align: left;">Verify users can change their memorized secret, and the change validates the current secret.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.4.6</strong></td>
<td style="text-align: left;">Verify that new or changed memorized secrets are validated against a list of compromised secrets, and if found to be compromised, the user is prompted to choose another secret.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.4.7</strong></td>
<td style="text-align: left;">Verify that a password strength meter is provided to help users set a stronger secret.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.4.8</strong></td>
<td style="text-align: left;">Verify that there are no enforced composition rules limiting the type of characters permitted (i.e. there should be no requirement for upper or lower case or numbers or special characters).</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.4.9</strong></td>
<td style="text-align: left;">Verify that there are no enforced arbitary or periodic credential rotation requirements.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.4.10</strong></td>
<td style="text-align: left;">Verify that the user is required to change their password if the credential has found to be compromised.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.4.11</strong></td>
<td style="text-align: left;">Verify that &quot;paste&quot; functionality, browser password helpers, and external password managers are permitted.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.4.12</strong></td>
<td style="text-align: left;">Verify that the user can choose to either temporarily view the masked entered password, or temporarily view the last typed character of the password.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
</tbody>
</table>
<h3 id="v2.5-credential-storage-requirements">V2.5 Credential Storage Requirements</h3>
<p>Architects and developers should adhere to this section when building or refactoring code. This section can only be fully verified using source code review, or through secure unit or integration tests. Penetration testing will not be able to identify any of these issues.</p>
<p>The list of approved one way key derivation functions is detailed in NIST 800-63 B section 5.1.1.2, and in <a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102.pdf?__blob=publicationFile">BSI Kryptographische Verfahren: Empfehlungen und Schlussellängen (2018)</a>. The latest national or regional algoritm and key length standards can be chosen in place of these choices.</p>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>2.5.1</strong></td>
<td style="text-align: left;">Verify that memorized secrets are stored in a form that is resistant to offline attacks. Memorized secrets SHALL be salted and hashed using an approved one-way key derivation or password hashing function. Key derivation and password hashing functions take a password and a cost factor as inputs then generate a password hash. These functions either require or generate their own salt as well.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.5.2</strong></td>
<td style="text-align: left;">Verify that the salt is at least 32 bits in length and be chosen arbitrarily so as to minimize salt value collisions among stored hashes. For each credential, a unique salt value and the resulting hash SHALL be stored.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.5.3</strong></td>
<td style="text-align: left;">Verify that if PBKDF2 is used, the iteration count SHOULD be as large as verification server performance will allow, typically at least 10,000 iterations.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.5.4</strong></td>
<td style="text-align: left;">Verify that if bcrypt is used, the work factor SHOULD be as large as verification server performance will allow, typically at least 13.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>2.5.5</strong></td>
<td style="text-align: left;">Verify that an additional iteration of a key derivation function using a salt value that is secret and known only to the verifier. This salt value, if used, SHALL be generated by an approved random bit generator [SP 800-90Ar1] and provide at least the minimum security strength specified in the latest revision of SP 800-131A. The secret salt value SHALL be stored separately from the hashed memorized secrets (e.g., in a specialized device like a hardware security module).</td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.1.2</td>
</tr>
</tbody>
</table>
<h3 id="v2.6-look-up-secret-requirements">V2.6 Look-up Secret Requirements</h3>
<p>Look up secrets are pre-generated lists of secret codes, similar to Transaction Authorization Numbers (TAN), Google Recovery Codes, or a grid containing a set of random values. These are distributed securely to users. These look up codes are used once and then not re-used. This type of authenticator is considered &quot;something you have&quot;.</p>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2.x.1</td>
<td style="text-align: left;">Verify that look-up secret authenticators use an approved random bit generator [SP 800-90Ar1] to generate the list of secrets. Look-up secrets SHALL have at least 20 bits of entropy.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.x.2</td>
<td style="text-align: left;">Verify that look-up secrets are delivered securely, and not over a clear text channel (SMS, email, etc)</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">5.1.2.1</td>
</tr>
</tbody>
</table>
<h3 id="v2.7-out-of-band-requirements">V2.7 Out of Band Requirements</h3>
<p>Out of band authenticators are physical devices controlled by the user. The verifying application and the out of band device must have an independant secure channel, and not use insecure channels such as PSTN or email. Examples include push notifications to mobile devices. This type of authenticator is considered &quot;something you have&quot;.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2.x.1</td>
<td style="text-align: left;">Verify that TBA.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">TBA</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.x.2</td>
<td style="text-align: left;">Verify that TBA.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">TBA</td>
</tr>
</tbody>
</table>
<h3 id="v2.8-single-factor-otp-requirements">V2.8 Single Factor OTP Requirements</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2.x.1</td>
<td style="text-align: left;">Verify that TBA.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">TBA</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.x.2</td>
<td style="text-align: left;">Verify that TBA.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">TBA</td>
</tr>
</tbody>
</table>
<h3 id="v2.9-multi-factor-otp-requirements">V2.9 Multi-factor OTP Requirements</h3>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>2.28</strong></td>
<td style="text-align: left;">Verify hardware-based authenticators and verifiers SHOULD resist relevant side-channel (e.g., timing and power-consumption analysis) attacks. Relevant side-channel attacks SHALL be determined by a risk assessment performed by the CSP.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.3.2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.34</strong></td>
<td style="text-align: left;">Verify that users can change their MFA enrollment.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">√</td>
<td style="text-align: left;">√</td>
<td style="text-align: left;">TBA</td>
</tr>
</tbody>
</table>
<h3 id="v2.10-cryptographic-software-and-devices">V2.10 Cryptographic Software and Devices</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2.x.1</td>
<td style="text-align: left;">Verify that TBA.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">TBA</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.x.2</td>
<td style="text-align: left;">Verify that TBA.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">TBA</td>
</tr>
</tbody>
</table>
<h3 id="v2.11-service-authentication-requirements">V2.11 Service Authentication Requirements</h3>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST §</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>2.21</strong></td>
<td style="text-align: left;">Integration secrets SHOULD NOT rely on unchanging memorized secrets, such as API keys or shared privileged accounts. If memorized secrets are required, the credential should not be a default account, and stored with sufficient protection to prevent offline recovery attacks, including local system access.</td>
<td style="text-align: left;">Software</td>
<td style="text-align: left;">OS assisted</td>
<td style="text-align: left;">HSM</td>
<td style="text-align: left;">5.1.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2.29</strong></td>
<td style="text-align: left;">Verify memorized secrets, integrations with databases and third party systems, seeds and internal secrets, and API keys are managed securely and not included in the source code or stored within source code repositories. Such storage SHOULD resist offline attacks. The use of a software secure key store (L1), hardware trusted platform module (TPM), or hardware security module (L3) is recommended for memorized secret storage.</td>
<td style="text-align: left;">Software</td>
<td style="text-align: left;">OS assisted</td>
<td style="text-align: left;">HSM</td>
<td style="text-align: left;">TBA</td>
</tr>
</tbody>
</table>
<h3 id="additional-us-agency-requirements">Additional US Agency Requirements</h3>
<p>US Agencies have mandatory requirements in relation to NIST 800-63. The Application Security Verification Standard has always been about the 80% of controls that apply to nearly 100% of apps, and not the last 20% of advanced controls or those that have limited applicability. As such, the ASVS is strict subset of NIST 800-63, especially for IAL1/2 and AAL1/2 classifications, but is not sufficiently comprehensive, particularly in relation to IAL3/AAL3 classifications.</p>
<p>We strongly urge US government agencies to review and implement NIST 800-63 in its entirety.</p>
<h2 id="glossary-of-terms">Glossary of terms</h2>
<table style="width:8%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CSP</td>
<td style="text-align: left;">Credential Service Provider, also called an Identity Provider</td>
</tr>
<tr class="even">
<td style="text-align: left;">Authenticator</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Verifier</td>
<td style="text-align: left;">&quot;An entity that verifies the claimant's identity by verifying the claimant's possession and control of one or two authenticators using an authentication protocol. To do this, the verifier may also need to validate credentials that link the authenticator(s) to the subscriber's identifier and check their status&quot;</td>
</tr>
<tr class="even">
<td style="text-align: left;">OTP</td>
<td style="text-align: left;">One time password</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SFA</td>
<td style="text-align: left;">Single factor authenticator, such as something you know (memorized secrets, passwords, pass phrases, PINs), something you are (biometrics, fingerprint, face scans), or something you have (OTP tokens, cryptographic device such as a smart card),</td>
</tr>
<tr class="even">
<td style="text-align: left;">MFA</td>
<td style="text-align: left;">Multi factor authenticator, which includes two or more single factors</td>
</tr>
</tbody>
</table>
<h2 id="references-1">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63-3.pdf">NIST 800-63 - Digital Identity Guidelines</a></li>
<li><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63a.pdf">NIST 800-63 A - Enrollment and Identity Proofing</a></li>
<li><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf">NIST 800-63 B - Authentication and Lifecycle Management</a></li>
<li><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63c.pdf">NIST 800-63 C - Federation and Assertions</a></li>
<li><a href="https://pages.nist.gov/800-63-FAQ/">NIST 800-63 FAQ</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_authentication">OWASP Testing Guide 4.0: Testing for Authentication</a></li>
<li><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet">Password storage cheat sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet">Forgot password cheat sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Choosing_and_Using_Security_Questions_Cheat_Sheet">Choosing and Using Security Questions at</a></li>
</ul>
<h1 id="v3-session-management-verification-requirements">V3: Session Management Verification Requirements</h1>
<h2 id="control-objective-2">Control Objective</h2>
<p>One of the core components of any web-based application is the mechanism by which it controls and maintains the state for a user interacting with it. This is referred to this as Session Management and is defined as the set of all controls governing state-full interaction between a user and the web-based application.</p>
<p>Ensure that a verified application satisfies the following high level session management requirements:</p>
<ul>
<li>Sessions are unique to each individual and cannot be guessed or shared.</li>
<li>Sessions are invalidated when no longer required and timed out during periods of inactivity.</li>
</ul>
<h2 id="security-verification-requirements-1">Security Verification Requirements</h2>
<h3 id="v3.1-fundamental-session-management-requirements">V3.1 Fundamental Session Management Requirements</h3>
<p>| <strong>3.1.1</strong> | Verify that logout functionality is easily found, and effective if used. | ✓ | ✓ | ✓ | 1.0 |<br />
| <strong>3.1.2</strong> | Verify that active session functionality exists, which allows users to either selectively or completely log out all active devices / sessions. | | ✓ | ✓ | 4.0 |<br />
| <strong>3.1.3</strong> | Test that the session token is never disclosed in URLs, error messages, or logs. This includes verifying that the application does not support URL rewriting of session cookies. | | | ✓ | 1.0 |<br />
| <strong>3.1.5</strong> | Verify that the user can terminate all other active sessions after a successful change password process, and this is effective across the application, federated login (if present) and any relying parties . | | ✓ | ✓ | 4.0 |</p>
<h3 id="v3.2-session-timeout-requirements">V3.2 Session Timeout Requirements</h3>
<p>Session timeouts have been aligned with NIST 800-63, which permits much longer session timeouts than traditionally permitted. This reflects modern common industry practice, but is backed by increasing timeouts when multi-factor or stronger authenticators are used.</p>
<p>L1 in this context is IAL1/AAL1, L2 is IAL2/AAL3, L3 is IAL3/AAL3. For IAL2/AAL2 and IAL3/AAL3, the shorter idle timeout is the lower bound of idle times for being logged out or re-authenticated to resume the session.</p>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>3.2.1</strong></td>
<td style="text-align: left;">Verify if authenticators permit users to remain logged in, that re-authentication occurs periodically both when actively used or after an idle period.</td>
<td style="text-align: left;">30 days</td>
<td style="text-align: left;">12 hours or 30 minutes of inactivity, 2FA optional</td>
<td style="text-align: left;">12 hours or 15 minutes of inactivity, with 2FA</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h3 id="v3.3-session-cryptography-requirements">V3.3 Session Cryptography Requirements</h3>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">X</td>
<td style="text-align: left;">Verify that session tokens generated using pseudo-random number generators are resistant to low entropy and time based attacks.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h3 id="v3.2-cookie-based-session-management">V3.2 Cookie based Session Management</h3>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>3.3.1</strong></td>
<td style="text-align: left;">Verify that only session IDs generated by the application framework are recognized as valid by the application.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>3.3.2</strong></td>
<td style="text-align: left;">Verify that session IDs stored in cookies are scoped using the 'path' attribute, and have the 'HttpOnly', 'Secure', and 'SameSite' cookie flags enabled.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>3.3.3</strong></td>
<td style="text-align: left;">Verify that cookie-based session IDs set prior to login are regenerated post login to a new secure value.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>3.3.4</strong></td>
<td style="text-align: left;">Verify that logout means logout. Upon logout, session IDs are fully invalidated in all locations they might appear, such that the back button or a downstream relying party does not resume an authenticated session.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h3 id="v3.3-token-based-session-management">V3.3 Token based Session Management</h3>
<p>Token based session management includes JWT, oAuth, SAML, and API keys. Of these, API keys are known weak and should not be used in new code.</p>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>3.3.1</strong></td>
<td style="text-align: left;">Verify that only session IDs generated by the application framework are recognized as valid by the application.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>3.3.1</strong></td>
<td style="text-align: left;">Verify single factor unchanging API secrets and keys are not used, except with legacy implementations.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">X</td>
<td style="text-align: left;">Verify that stateless session tokens enveloping sensitive session data are digitally signed or encrypted and regularly verified in a timely fasion to protect against tampering, enveloping, replay, null cipher and and key substitution attacks.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h3 id="v3.4-single-sign-on">V3.4 Single Sign On</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<h3 id="v3.5-delegation-session-management">V3.5 Delegation Session Management</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<h3 id="v3.6-federated-session-management">V3.6 Federated Session Management</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<h3 id="v3.7-defences-against-session-management-exploits">V3.7 Defences against session management exploits</h3>
<p>There are a small number of session management attacks, some releated to the user experience (UX) of sessions. Previously, we have asked that multiple sessions be blocked, based on ISO 27002 requirements. This is not appropriate, as typically the last authenticator wins, and that is often the attacker. This section provides leading guideance on detering, delaying and detecting session management attacks using code.</p>
<p>Description on the half-open attack</p>
<p>In early 2018, a number of financial insitutions were compromised using what the attackers called &quot;half open attacks&quot;. This term has stuck in the industry. The attackers struck multiple institutions with different proprietary code bases, and indeed it seems different code bases within the same institutions. This means the half open attack is exploiting a design pattern flaw commonly found in many existing authentication, session management and access control systems.</p>
<p>Attackers will attempt a half-open attack by starting with attempting to lock, reset, or recover a credential. A popular design pattern re-uses user profile session objects / models between unauthenticated, half-authenticated (resets, etc), and fully authenticated code. This design pattern populates a valid session object or token containing the victim's profile, including password hashses and roles. If access control checks in controllers or routers does not correctly verify that the user is actually logged in, the attacker will be able to change the user's password to a known value, update the profile or email address to perform a valid password reset, disable multi-factor authentication or enrol a new MFA device, change API keys, and so on.</p>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">NIST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>3.7.1</strong></td>
<td style="text-align: left;">Verify that all post-reset, post-registration, and post-authentication high value or adminstrative functionality verifies the user session is both fully logged in and has a valid post-authentication role before permitting any changes or transactions, especially in relation to user profile updates, password changes, MFA enrollment, and administrative functionality.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h2 id="references-2">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Testing_for_Session_Management">OWASP Testing Guide 4.0: Session Management Testing</a></li>
<li><a href="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet">OWASP Session Management Cheat Sheet</a></li>
</ul>
<h1 id="v4-access-control-verification-requirements">V4: Access Control Verification Requirements</h1>
<h2 id="control-objective-3">Control Objective</h2>
<p>Authorization is the concept of allowing access to resources only to those permitted to use them. Ensure that a verified application satisfies the following high level requirements:</p>
<ul>
<li>Persons accessing resources holds valid credentials to do so.</li>
<li>Users are associated with a well-defined set of roles and privileges.</li>
<li>Role and permission metadata is protected from replay or tampering.</li>
</ul>
<h2 id="security-verification-requirements-2">Security Verification Requirements</h2>
<p>| # | Description | L1 | L2 | L3 | Since |<br />
| --- | --- | --- | --- | -- | -- |<br />
| <strong>4.1</strong> | Verify that the principle of least privilege exists - users should only be able to access functions, data files, URLs, controllers, services, and other resources, for which they possess specific authorization. This implies protection against spoofing and elevation of privilege. | ✓ | ✓ | ✓ | 1.0 |<br />
| <strong>4.4</strong> | Verify that sensitive data and APIs are protected against direct object attacks targeting creation, reading, updating and deletion of records. | ✓ | ✓ | ✓ | 4.0 |<br />
| <strong>4.5</strong> | Verify that directory browsing is disabled unless deliberately desired. Additionally, applications should not allow discovery or disclosure of file or directory metadata, such as Thumbs.db, .DS_Store, .git or .svn folders. | ✓ | ✓ | ✓ | 1.0 |<br />
| <strong>4.8</strong> | Verify that access controls fail securely. | ✓ | ✓ | ✓ | 1.0 |<br />
| <strong>4.9</strong> | Verify that the same access control rules implied by the presentation layer are enforced on the server side. | ✓ | ✓ | ✓ | 1.0 |<br />
| <strong>4.10</strong> | Verify that all user and data attributes and policy information used by access controls cannot be manipulated by end users unless specifically authorized. | | ✓ | ✓ | 1.0 |<br />
| <strong>4.11</strong> | Verify that there is preferably only one vetted access control mechanism for protecting access to protected data and resources, such that hard coded access control checks are not required throughout the application. | | ✓ | ✓ | 4.0 |<br />
| <strong>4.12</strong> | Verify that all access control decisions can be logged and all failed decisions are logged. | | ✓ | ✓ | 2.0 |<br />
| <strong>4.13</strong> | Verify that the application or framework enforces a strong anti-CSRF mechanism any sensitive functionality. | ✓ | ✓ | ✓ | 4.0 |<br />
| <strong>4.14</strong> | Verify the application has sufficient anti-automation to detect and protect against data exfiltration, excessive business logic requests, or denial of service attacks. | | ✓ | ✓ | 4.0 |<br />
| <strong>4.15</strong> | Verify the application has additional authorization (such as step up or adaptive authentication) for lower value systems, and / or segregation of duties for high value applications to enforce anti-fraud controls as per the risk of application and past fraud. | | ✓ | ✓ | 3.0 |<br />
| <strong>4.16</strong> | Verify that access control policy is enforced by trusted server-side components. | ✓ | ✓ | ✓ | 4.0 |<br />
| <strong>4.17</strong> | Verify that data-level access control is implemented such that access to individual records can be managed in a centralized and standard way. | ✓ | ✓ | ✓ | 4.0 |<br />
| <strong>2.32</strong> | Verify administrative interfaces use appropriate multi-factor authentication to prevent unauthorized use. | ✓ | ✓ | ✓ | 4.0 | TBA |</p>
<h2 id="references-3">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Testing_for_Authorization">OWASP Testing Guide 4.0: Authorization</a></li>
<li><a href="https://www.owasp.org/index.php/Access_Control_Cheat_Sheet">OWASP Cheat Sheet: Access Control</a></li>
<li><a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet">OWASP CSRF Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/REST_Security_Cheat_Sheet">OWASP REST Cheat Sheet</a></li>
<li><p>Anti-automation can be achieved in many ways, including the user of <a href="https://www.owasp.org/index.php/OWASP_AppSensor_Project">OWASP AppSensor</a> and <a href="https://www.owasp.org/index.php/OWASP_Automated_Threats_to_Web_Applications">OWASP Automated Threats to Web Applications</a></p>
<h1 id="v5-validation-sanitization-and-encoding-verification-requirements">V5: Validation, Sanitization and Encoding Verification Requirements</h1></li>
</ul>
<h2 id="control-objective-4">Control Objective</h2>
<p>The most common web application security weakness is the failure to properly validate input coming from the client or from the environment before using it. This weakness leads to almost all of the major vulnerabilities in web applications, such as Cross-Site Scripting (XSS), SQL injection, interpreter injection, locale/Unicode attacks, file system attacks, and buffer overflows.</p>
<p>Ensure that a verified application satisfies the following high level requirements:</p>
<ul>
<li>All input is validated to be correct and fit for the intended purpose.</li>
<li>Data from an external entity or client should never be trusted and should be handled accordingly.</li>
</ul>
<h2 id="security-verification-requirements-3">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>5.1</strong></td>
<td style="text-align: left;">Verify that server-side input validation failures result in request rejection and are logged.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>5.2</strong></td>
<td style="text-align: left;">Verify that input validation is enforced on the server-side.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5.3</strong></td>
<td style="text-align: left;">Verify that a centralized input validation control mechanism is used by the application.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>5.4</strong></td>
<td style="text-align: left;">Verify that data selection or database queries (e.g. SQL, HQL, ORM, NoSQL, XPath, LDAP) are protected from respective injection attacks. In cases where query parameterization or escaping is not possible for certain variables, be sure to strictly validate or whitelist the data, such as ORDER BY values, or column names.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5.5</strong></td>
<td style="text-align: left;">Verify that the application is not susceptible to LDAP Injection, or that security controls prevent LDAP Injection.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>5.6</strong></td>
<td style="text-align: left;">Verify that the application is not susceptible to OS Command Injection, or that security controls prevent OS Command Injection.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5.7</strong></td>
<td style="text-align: left;">Verify that the application is not susceptible to Remote File Inclusion (RFI) or Local File Inclusion (LFI) when content is used that is a path to a file.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>5.8</strong></td>
<td style="text-align: left;">Verify that the application is not susceptible XPath injection or XML injection attacks.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5.9</strong></td>
<td style="text-align: left;">Verify that all string variables placed into HTML or other web client code are either properly contextually encoded manually, or utilize templates that automatically contextually encode to ensure the application is not susceptible to reflected, stored or DOM Cross-Site Scripting (XSS) attacks.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>5.10</strong></td>
<td style="text-align: left;">Verify that the application does not contain mass parameter assignment (AKA automatic variable binding) vulnerabilities.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5.11</strong></td>
<td style="text-align: left;">Verify that the application has defenses against HTTP parameter pollution attacks, particularly if the application framework makes no distinction about the source of request parameters (GET, POST, cookies, headers, environment, etc).</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>5.12</strong></td>
<td style="text-align: left;">Verify that all input data is validated, not only HTML form fields but all sources of input such as REST calls, query parameters, HTTP headers, cookies, batch files, RSS feeds, etc; using positive validation (whitelisting), then lesser forms of validation such as grey listing (eliminating known bad strings), or rejecting bad inputs (blacklisting).</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5.13</strong></td>
<td style="text-align: left;">Verify that structured data is strongly typed and validated against a defined schema including allowed characters, length and pattern (e.g. credit card numbers or telephone, or validating that two related fields are reasonable, such as validating suburbs and zip or post codes match).</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>5.14</strong></td>
<td style="text-align: left;">Verify that unstructured data is sanitized to enforce generic safety measures such as allowed characters and length, and characters potentially harmful in given context should be escaped (e.g. natural names with Unicode or apostrophes, such as ねこ or O'Hara).</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5.15</strong></td>
<td style="text-align: left;">Verify that all untrusted HTML input from WYSIWYG editors or similar is properly sanitized with an HTML sanitizer library or framework feature.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>5.16</strong></td>
<td style="text-align: left;">Verify that where data is transferred from one DOM context to another, the transfer uses safe JavaScript methods, such as using innerText or JQuery .val to ensure the application is not susceptible to DOM Cross-Site Scripting (XSS) attacks.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5.17</strong></td>
<td style="text-align: left;">Verify when parsing JSON in browsers or JavaScript based backends, that JSON.parse is used to parse the JSON document. Do not use eval() to parse JSON.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>5.18</strong></td>
<td style="text-align: left;">Verify the application for Server-Side Request Forgery vulnerabilities.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5.19</strong></td>
<td style="text-align: left;">Verify that the application correctly restricts XML parsers to only use the most restrictive configuration possible and to ensure that dangerous features such as resolving external entities are disabled.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>5.20</strong></td>
<td style="text-align: left;">Verify that deserialization of untrusted data is avoided or is extensively protected in both custom code and third party libraries (such as JSON, XML and YAML parsers).</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h2 id="references-4">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Testing_for_Input_Validation">OWASP Testing Guide 4.0: Input Validation Testing</a></li>
<li><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">OWASP Cheat Sheet: Input Validation</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_HTTP_Parameter_pollution_%28OTG-INPVAL-004%29">OWASP Testing Guide 4.0: Testing for HTTP Parameter Pollution</a></li>
<li><a href="https://www.owasp.org/index.php/LDAP_Injection_Prevention_Cheat_Sheet">OWASP LDAP Injection Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Client_Side_Testing">OWASP Testing Guide 4.0: Client Side Testing</a></li>
<li><a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet">OWASP Cross Site Scripting Prevention Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet">OWASP DOM Based Cross Site Scripting Prevention Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Java_Encoder_Project">OWASP Java Encoding Project</a></li>
</ul>
<p>For more information on auto-escaping, please see:</p>
<ul>
<li><a href="http://googleonlinesecurity.blogspot.com/2009/03/reducing-xss-by-way-of-automatic.html">Reducing XSS by way of Automatic Context-Aware Escaping in Template Systems</a></li>
<li><a href="https://docs.angularjs.org/api/ng/service/$sce">AngularJS Strict Contextual Escaping</a></li>
<li><a href="https://docs.angularjs.org/api/ng/directive/ngBind">AngularJS ngBind</a></li>
<li><a href="https://angular.io/guide/security#sanitization-and-security-contexts">Angular Sanitzation</a></li>
<li><a href="https://angular.io/guide/template-syntax#content-security">Angular Template Security</a></li>
<li><a href="https://reactjs.org/docs/introducing-jsx.html#jsx-prevents-injection-attacks">ReactJS Escaping</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/915.html">Improperly Controlled Modification of Dynamically-Determined Object Attributes</a></li>
</ul>
<h1 id="v7-cryptography-verification-requirements">V7: Cryptography Verification Requirements</h1>
<h2 id="control-objective-5">Control Objective</h2>
<p>Ensure that a verified application satisfies the following high level requirements:</p>
<ul>
<li>That all cryptographic modules fail in a secure manner and that errors are handled correctly.</li>
<li>That a suitable random number generator is used when randomness is required.</li>
<li>That access to keys is managed in a secure way.</li>
</ul>
<h2 id="security-verification-requirements-4">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>7.2</strong></td>
<td style="text-align: left;">Verify that all cryptographic modules fail securely, and errors are handled in a way that does not enable Padding Oracle attacks.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>7.6</strong></td>
<td style="text-align: left;">Verify that all random numbers, random file names, random GUIDs, and random strings are generated using the cryptographic module’s approved random number generator when these random values are intended to be not guessable by an attacker.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>7.7</strong></td>
<td style="text-align: left;">Verify that cryptographic algorithms used by the application have been validated against FIPS 140-2 or an equivalent standard.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>7.11</strong></td>
<td style="text-align: left;">Verify that consumers of cryptographic services do not have direct access to key material, such as by using key vaults or API based alternatives.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>7.12</strong></td>
<td style="text-align: left;">Verify that Personally Identifiable Information (PII) and other sensitive data is stored encrypted while at rest.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>7.13</strong></td>
<td style="text-align: left;">Verify that sensitive passwords or key material maintained in memory is overwritten with zeros as soon as it is no longer required, to mitigate memory dumping attacks.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>7.14</strong></td>
<td style="text-align: left;">Verify that all keys and passwords are replaceable, and are generated or replaced at installation time.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>7.15</strong></td>
<td style="text-align: left;">Verify that random numbers are created with proper entropy even when the application is under heavy load, or that the application degrades gracefully in such circumstances.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>7.16</strong></td>
<td style="text-align: left;">Verify that industry proven cryptographic modules are used instead of custom coded cryptography.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h2 id="references-5">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Testing_for_weak_Cryptography">OWASP Testing Guide 4.0: Testing for weak Cryptography</a></li>
<li><a href="https://www.owasp.org/index.php/Cryptographic_Storage_Cheat_Sheet">OWASP Cheat Sheet: Cryptographic Storage</a></li>
</ul>
<h1 id="v8-error-handling-and-logging-verification-requirements">V8: Error Handling and Logging Verification Requirements</h1>
<h2 id="control-objective-6">Control Objective</h2>
<p>The primary objective of error handling and logging is to provide a useful reaction by the user, administrators, and incident response teams. The objective is not to create massive amounts of logs, but high quality logs, with more signal than discarded noise.</p>
<p>High quality logs will often contain sensitive data, and must be protected as per local data privacy laws or directives. This should include:</p>
<ul>
<li>Not collecting or logging sensitive information if not specifically required.</li>
<li>Ensuring all logged information is handled securely and protected as per its data classification.</li>
<li>Ensuring that logs are not forever, but have an absolute lifetime that is as short as possible.</li>
</ul>
<p>If logs contain private or sensitive data, the definition of which varies from country to country, the logs become some of the most sensitive information held by the application and thus very attractive to attackers in their own right.</p>
<h2 id="security-verification-requirements-5">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>8.1</strong></td>
<td style="text-align: left;">Verify that the application does not output error messages or stack traces containing sensitive data that could assist an attacker, including session id, software/framework versions and personal information.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>8.3</strong></td>
<td style="text-align: left;">Verify that the application logs security relevant events including successful and failed authentication events, access control failures and input validation failures.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>8.4</strong></td>
<td style="text-align: left;">Verify that each log event includes necessary information that would allow for a detailed investigation of the timeline when an event happens.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>8.5</strong></td>
<td style="text-align: left;">Verify that all events that include untrusted data will not execute as code in the intended log viewing software.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>8.6</strong></td>
<td style="text-align: left;">Verify that security logs are protected from unauthorized access and modification.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>8.7</strong></td>
<td style="text-align: left;">Verify that the application does not log credentials, session tokens, payment instruments, or sensitive data, as defined under local privacy laws or relevant security policy.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>8.8</strong></td>
<td style="text-align: left;">Verify the application appropriately encodes user supplied data to prevent log injection.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>8.12</strong></td>
<td style="text-align: left;">Verify that logs are transmitted to a remote system for analysis, detection, alerting, and escalation.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>8.13</strong></td>
<td style="text-align: left;">Verify that time sources are synchronized to the correct time and time zone.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>8.14</strong></td>
<td style="text-align: left;">Verify all authentication decisions are logged, without storing sensitive session identifiers or memorized secrets. This should include requests with relevant metadata needed for security investigations.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h2 id="references-6">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Testing_for_Error_Handling">OWASP Testing Guide 4.0 content: Testing for Error Handling</a></li>
</ul>
<h1 id="v9-data-protection-verification-requirements">V9: Data Protection Verification Requirements</h1>
<h2 id="control-objective-7">Control Objective</h2>
<p>There are three key elements to sound data protection: Confidentiality, Integrity and Availability (CIA). This standard assumes that data protection is enforced on a trusted system, such as a server, which has been hardened and has sufficient protections.</p>
<p>Applications have to assume that all user devices are compromised in some way. Where an application transmits or stores sensitive information on insecure devices, such as shared computers, phones and tablets, the application is responsible for ensuring data stored on these devices is encrypted and cannot be easily illicitly obtained, altered or disclosed.</p>
<p>Ensure that a verified application satisfies the following high level data protection requirements:</p>
<ul>
<li>Confidentiality: Data should be protected from unauthorized observation or disclosure both in transit and when stored.</li>
<li>Integrity: Data should be protected being maliciously created, altered or deleted by unauthorized attackers.</li>
<li>Availability: Data should be available to authorized users as required.</li>
</ul>
<h2 id="security-verification-requirements-6">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>9.2</strong></td>
<td style="text-align: left;">Verify that sensitive data is classified and a policy is created for how this data must be protected.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>9.3</strong></td>
<td style="text-align: left;">Verify that sensitive data is sent to the server in the HTTP/S message body or headers and that all query string parameters from any HTTP verb does not contain sensitive data.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>9.4</strong></td>
<td style="text-align: left;">Verify that the application sets sufficient anti-caching headers such that any sensitive and personal information displayed by the application or entered by the user should not be cached on disk by mainstream modern browsers (e.g. visit <a href="about:cache" class="uri">about:cache</a> to review disk cache).</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>9.5</strong></td>
<td style="text-align: left;">Verify that on the server, all cached or temporary copies of sensitive data stored are protected from unauthorized access or purged/invalidated after the authorized user accesses the sensitive data.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>9.6</strong></td>
<td style="text-align: left;">Verify that users have a method to remove or export their data on demand.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>9.7</strong></td>
<td style="text-align: left;">Verify the application minimizes the number of parameters in a request, such as hidden fields, Ajax variables, cookies and header values.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>9.8</strong></td>
<td style="text-align: left;">Verify the application has the ability to detect and alert on abnormal numbers of requests.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>9.9</strong></td>
<td style="text-align: left;">Verify that data stored in client side storage (such as HTML5 local storage, session storage, IndexedDB, regular cookies or Flash cookies) does not contain sensitive data or PII.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>9.10</strong></td>
<td style="text-align: left;">Verify accessing sensitive data is logged, if the data is collected under relevant data protection directives or where logging of accesses is required.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>9.11</strong></td>
<td style="text-align: left;">Verify that sensitive information maintained in memory is overwritten with zeros as soon as it is no longer required, to mitigate memory dumping attacks.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>9.12</strong></td>
<td style="text-align: left;">Verify that sensitive or private information that is required to be encrypted, is encrypted using approved algorithms that provides both confidentiality and integrity.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>9.13</strong></td>
<td style="text-align: left;">Verify that users are provided clear language regarding collection and use of supplied personal information and that users have provided opt in consent for the use of that data before it is used in any way.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>9.14</strong></td>
<td style="text-align: left;">Verify that authenticated data is cleared from client storage, such as the browser DOM, after the client or session is terminated.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
</tbody>
</table>
<h2 id="references-7">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://securityheaders.io">Consider using Security Headers website to check security and anti-caching headers</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Secure_Headers_Project">OWASP Secure Headers project</a></li>
<li><a href="https://www.owasp.org/index.php/User_Privacy_Protection_Cheat_Sheet">User Privacy Protection Cheat Sheet</a></li>
</ul>
<h1 id="v10-communications-verification-requirements">V10: Communications Verification Requirements</h1>
<h2 id="control-objective-8">Control Objective</h2>
<p>Ensure that a verified application satisfies the following high level requirements:</p>
<ul>
<li>TLS or strong encryption is always used, regardless of the sensitivity of the data being transmitted</li>
<li>The most recent leading configuration advice is used to enable and order preferred algorithms and ciphers</li>
<li>Weak or soon to be deprecated algorithms and ciphers are ordered as a last resort</li>
<li>Deprecated or known insecure algorithms and ciphers are disabled.</li>
</ul>
<p>Leading industry advice on secure TLS configuration changes frequently, often due to catastrophic breaks in existing algorithms and ciphers. Always use the most recent versions of TLS configuration review tools (such as SSLyze or other TLS scanners) to configure the preferred order and algorithm selection. Configuration should be periodically checked to ensure that secure communications configuration is always present and effective.</p>
<h2 id="security-verification-requirements-7">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>10.1</strong></td>
<td style="text-align: left;">Verify that a path can be built from a trusted CA to each Transport Layer Security (TLS) server certificate, and that each server certificate is valid.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>10.3</strong></td>
<td style="text-align: left;">Verify that TLS is used for all connections (including for authentication, API or web service calls, backend, external, and partner connections), and does not fall back to insecure or unencrypted protocols.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>10.4</strong></td>
<td style="text-align: left;">Verify that backend TLS connection failures are logged.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>10.5</strong></td>
<td style="text-align: left;">Verify that certificate paths are built and verified for all client certificates using configured trust anchors and revocation information.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>10.6</strong></td>
<td style="text-align: left;">Verify that all connections to external systems that involve sensitive information or functions are authenticated.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>10.11</strong></td>
<td style="text-align: left;">Verify that HTTP Strict Transport Security headers are included on all requests and for all subdomains, such as Strict-Transport-Security: max-age=15724800; includeSubdomains.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>10.12</strong></td>
<td style="text-align: left;">Verify that the application's URL has been submitted to a preloaded list of Strict Transport Security domains maintained by web browser vendors. Please see the references below.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>10.14</strong></td>
<td style="text-align: left;">Verify that proper certification revocation, such as Online Certificate Status Protocol (OCSP) Stapling, is enabled and configured.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>10.15</strong></td>
<td style="text-align: left;">Verify that only strong algorithms, ciphers, and protocols are enabled, with the strongest algorithms and ciphers set as preferred, to provide both confidentiality and integrity.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>10.17</strong></td>
<td style="text-align: left;">Verify that old versions of SSL and TLS protocols, algorithms, ciphers, and configuration are not used, such as SSLv2/3 or TLS 1.0. The latest version of TLS should be the preferred cipher suite.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
</tbody>
</table>
<h2 id="references-8">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet">OWASP – TLS Cheat Sheet</a></li>
<li>Notes on “Approved modes of TLS”. In the past, the ASVS referred to the US standard FIPS 140-2, but as a global standard, applying US standards can be difficult, contradictory, or confusing to apply. A better method of achieving compliance with 10.8 would be to review guides such as <a href="https://wiki.mozilla.org/Security/Server_Side_TLS">Mozilla's Server Side TLS</a> or <a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/">generate known good configurations</a>, and use known TLS evaluation tools, such as sslyze, various vulnerability scanners or trusted TLS online assessment services to obtain a desired level of security. In general, we see non-compliance for this section being the use of outdated or insecure ciphers and algorithms, the lack of perfect forward secrecy, outdated or insecure SSL protocols, weak preferred ciphers, and so on.</li>
<li><a href="https://tools.ietf.org/html/rfc7469">Certificate pinning</a>. The rationale behind certificate pinning for production and backup keys is <a href="https://noncombatant.org/2015/05/01/about-http-public-key-pinning/">business continuity</a></li>
<li><a href="https://www.owasp.org/index.php/Pinning_Cheat_Sheet">OWASP Certificate Pinning Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning">OWASP Certificate and Public Key Pinning</a></li>
<li><a href="https://developer.mozilla.org/en/docs/Web/Security/Public_Key_Pinning">Time of first use (TOFU) Pinning</a></li>
<li><a href="https://www.chromium.org/hsts">Pre-loading HTTP Strict Transport Security</a></li>
</ul>
<h1 id="v11-http-security-configuration-verification-requirements">V11: HTTP Security Configuration Verification Requirements</h1>
<h2 id="control-objective-9">Control Objective</h2>
<p>Ensure that a verified application satisfies the following high level requirements:</p>
<ul>
<li>The application server is suitably hardened from a default configuration.</li>
<li>HTTP responses contain a safe character set in the content type header.</li>
</ul>
<h2 id="security-verification-requirements-8">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>11.1</strong></td>
<td style="text-align: left;">Verify that the application server accepts the HTTP methods in use by the application or API, including pre-flight OPTIONS.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>11.2</strong></td>
<td style="text-align: left;">Verify that every HTTP response contains a content type header specifying a safe character set (e.g., UTF-8, ISO 8859-1).</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>11.3</strong></td>
<td style="text-align: left;">Verify that HTTP headers added by a trusted proxy or SSO devices, such as a bearer token, are authenticated by the application.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>11.4</strong></td>
<td style="text-align: left;">Verify that a suitable X-Frame-Options or Content-Security-Policy: frame-ancestors header is in use for sites where content should not be embedded in a 3rd party site.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>11.5</strong></td>
<td style="text-align: left;">Verify that the HTTP headers or any part of the HTTP response do not expose detailed version information of system components.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>11.6</strong></td>
<td style="text-align: left;">Verify that all API responses contain X-Content-Type-Options: nosniff and Content-Disposition: attachment; filename=&quot;api.json&quot; (or other appropriate filename for the content type).</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>11.7</strong></td>
<td style="text-align: left;">Verify that a content security policy (CSPv2) is in place that helps mitigate common DOM, XSS, JSON, and JavaScript injection vulnerabilities.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>11.8</strong></td>
<td style="text-align: left;">Verify that the X-XSS-Protection: 1; mode=block header is in place to enable browser reflected XSS filters.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>11.9</strong></td>
<td style="text-align: left;">Verify that the supplied Origin header is not used for authentication or access control decisions, as the Origin header can easily be changed by an attacker.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h2 id="references-9">References</h2>
<p>For more information, please see:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Testing_for_HTTP_Verb_Tampering_%28OTG-INPVAL-003%29">OWASP Testing Guide 4.0: Testing for HTTP Verb Tampering</a></li>
<li>Adding Content-Disposition to API responses helps prevent many attacks based on misunderstanding on the MIME type between client and server, and the &quot;filename&quot; option specifically helps prevent <a href="https://www.blackhat.com/docs/eu-14/materials/eu-14-Hafif-Reflected-File-Download-A-New-Web-Attack-Vector.pdf">Reflected File Download attacks.</a></li>
<li><a href="https://www.owasp.org/index.php?title=Content_Security_Policy_Cheat_Sheet">Content Security Policy Cheat Sheet</a></li>
<li><a href="https://portswigger.net/blog/exploiting-cors-misconfigurations-for-bitcoins-and-bounties">Exploiting CORS misconfiguration for BitCoins and Bounties</a></li>
</ul>
<h1 id="v13-malicious-code-verification-requirements">V13: Malicious Code Verification Requirements</h1>
<h2 id="control-objective-10">Control Objective</h2>
<p>Ensure that a verified application satisfies the following high level requirements:</p>
<ul>
<li>Malicious activity is handled securely and properly as to not affect the rest of the application.</li>
<li>Do not have time bombs or other time based attacks built into them.</li>
<li>Do not “phone home” to malicious or unauthorized destinations.</li>
<li>Applications do not have back doors, Easter eggs, salami attacks, or logic flaws that can be controlled by an attacker.</li>
</ul>
<p>Malicious code is extremely rare, and is difficult to detect. Manual line by line code review can assist looking for logic bombs, but even the most experienced code reviewer will struggle to find malicious code even if they know it exists. This section is not possible to complete without access to source code, including as many third party libraries as possible.</p>
<h2 id="security-verification-requirements-9">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>13.1</strong></td>
<td style="text-align: left;">Verify all malicious activity is adequately sandboxed, containerized or isolated to delay and deter attackers from attacking other applications.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>13.2</strong></td>
<td style="text-align: left;">Verify that the application source code and third party libraries do not contain back doors or easter eggs.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0.1</td>
</tr>
</tbody>
</table>
<h2 id="references-10">References</h2>
<h1 id="v15-business-logic-verification-requirements">V15: Business Logic Verification Requirements</h1>
<h2 id="control-objective-11">Control Objective</h2>
<p>Ensure that a verified application satisfies the following high level requirements:</p>
<ul>
<li>The business logic flow is sequential, cannot be obviated, and processed in order.</li>
<li>Business logic includes limits to detect and prevent automated attacks, such as continuous small funds transfers, or adding a million friends one at a time, and so on.</li>
<li>High value business logic flows have considered abuse cases and malicious actors, and have protections against spoofing, tampering, repudiation, information disclosure, and elevation of privilege attacks.</li>
</ul>
<h2 id="security-verification-requirements-10">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>15.1</strong></td>
<td style="text-align: left;">Verify the application will only process business logic flows in sequential step order, with all steps being processed in realistic human time, and not process out of order, skipped steps, process steps from another user, or too quickly submitted transactions.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>15.2</strong></td>
<td style="text-align: left;">Verify the application has business limits and correctly enforces on a per user basis, with configurable alerting and automated reactions to automated or unusual attack.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
</tbody>
</table>
<h2 id="references-11">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Testing_for_business_logic">OWASP Testing Guide 4.0: Business Logic Testing</a></li>
<li><a href="https://www.owasp.org/index.php/Business_Logic_Security_Cheat_Sheet">OWASP Cheat Sheet</a></li>
</ul>
<h1 id="v16-file-and-resources-verification-requirements">V16: File and Resources Verification Requirements</h1>
<h2 id="control-objective-12">Control Objective</h2>
<p>Ensure that a verified application satisfies the following high level requirements:</p>
<ul>
<li>Untrusted file data should be handled accordingly and in a secure manner.</li>
<li>Obtained from untrusted sources are stored outside the web root and limited permissions.</li>
</ul>
<h2 id="security-verification-requirements-11">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>16.1</strong></td>
<td style="text-align: left;">Verify that URL redirects and forwards only allow whitelisted destinations, or show a warning when redirecting to potentially untrusted content.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>16.2</strong></td>
<td style="text-align: left;">Verify that untrusted file data submitted to the application is not used directly with file I/O commands, particularly to protect against path traversal, local file include, file mime type, reflective file download, and OS command injection vulnerabilities.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>16.3</strong></td>
<td style="text-align: left;">Verify that files obtained from untrusted sources are validated to be of expected type and scanned by antivirus scanners to prevent upload of known malicious content.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>16.4</strong></td>
<td style="text-align: left;">Verify that untrusted data is not used within inclusion, class loader, or reflection capabilities to prevent remote/local code execution vulnerabilities.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>16.5</strong></td>
<td style="text-align: left;">Verify that untrusted data is not used within cross-domain resource sharing (CORS) to protect against arbitrary remote content.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>16.6</strong></td>
<td style="text-align: left;">Verify that files obtained from untrusted sources are stored outside the web root, with limited permissions, preferably with strong validation.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>16.7</strong></td>
<td style="text-align: left;">Verify that the web or application server is configured by default to deny access to remote resources or systems outside the web or application server.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>16.8</strong></td>
<td style="text-align: left;">Verify the application code does not execute uploaded data obtained from untrusted sources.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>16.9</strong></td>
<td style="text-align: left;">Verify that unsupported, insecure or deprecated client-side technologies are not used, such as NSAPI plugins, Flash, Shockwave, Active-X, Silverlight, NACL, or client-side Java applets.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>16.10</strong></td>
<td style="text-align: left;">Verify that the cross-domain resource sharing (CORS) Access-Control-Allow-Origin header does not reflect the request's origin header or support the &quot;null&quot; origin.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h2 id="references-12">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Unrestricted_File_Upload">File Extension Handling for Sensitive Information</a></li>
<li><a href="https://www.trustwave.com/Resources/SpiderLabs-Blog/Reflected-File-Download---A-New-Web-Attack-Vector/">Reflective file download by Oren Hatif</a></li>
</ul>
<h1 id="v17-mobile-verification-requirements">V17: Mobile Verification Requirements</h1>
<h2 id="asvs-mobile-removal-notice">ASVS Mobile Removal Notice</h2>
<p>This section previously contained controls that are mobile application specific. This section is being removed and replaced by the OWASP Mobile Application Security Verification Standard.</p>
<h2 id="references-13">References</h2>
<ul>
<li><p><a href="https://www.owasp.org/index.php/OWASP_Mobile_Security_Project">OWASP Mobile Application Security Verification Standard</a></p>
<h1 id="v18-api-and-web-service-verification-requirements">V18: API and Web Service Verification Requirements</h1></li>
</ul>
<h2 id="control-objective-13">Control Objective</h2>
<p>Ensure that a verified application that uses RESTful or SOAP based web services has:</p>
<ul>
<li>Adequate authentication, session management and authorization of all web services.</li>
<li>Input validation of all parameters that transit from a lower to higher trust level.</li>
<li>Basic interoperability of SOAP web services layer to promote API use.</li>
</ul>
<h2 id="security-verification-requirements-12">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>18.1</strong></td>
<td style="text-align: left;">Verify that the same encoding style is used between the client and the server.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>18.2</strong></td>
<td style="text-align: left;">Verify that access to administration and management functions within the Web Service Application is limited to web service administrators.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>18.3</strong></td>
<td style="text-align: left;">Verify that XML or JSON schema is in place and verified before accepting input.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>18.4</strong></td>
<td style="text-align: left;">Verify that all input is limited to an appropriate size limit.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>18.5</strong></td>
<td style="text-align: left;">Verify that SOAP based web services are compliant with Web Services-Interoperability (WS-I) Basic Profile at minimum. This essentially means TLS encryption.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>18.7</strong></td>
<td style="text-align: left;">Verify that the REST service is protected from Cross-Site Request Forgery via the use of at least one or more of the following: double submit cookie pattern, CSRF nonces, ORIGIN request header checks, and referrer request header checks.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>18.8</strong></td>
<td style="text-align: left;">Verify the REST service explicitly check the incoming Content-Type to be the expected one, such as application/xml or application/json.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>18.9</strong></td>
<td style="text-align: left;">Verify that the message payload is signed to ensure reliable transport between client and service, using JSON Web Signing or WS-Security for SOAP requests.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>18.10</strong></td>
<td style="text-align: left;">Verify that alternative and less secure access paths do not exist.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
</tbody>
</table>
<h2 id="references-14">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Testing_for_configuration_management">OWASP Testing Guide 4.0: Configuration and Deployment Management Testing</a></li>
<li><a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet">OWASP Cross-Site Request Forgery cheat sheet</a></li>
<li><a href="https://jwt.io/">JSON Web Tokens (and Signing)</a></li>
</ul>
<h1 id="v19-configuration-verification-requirements">V19: Configuration Verification Requirements</h1>
<h2 id="control-objective-14">Control Objective</h2>
<p>Ensure that a verified application has:</p>
<ul>
<li>Up to date libraries and platform(s).</li>
<li>A secure by default configuration.</li>
<li>Sufficient hardening that user initiated changes to default configuration do not unnecessarily expose or create security weaknesses or flaws to underlying systems.</li>
</ul>
<h2 id="security-verification-requirements-13">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>19.1</strong></td>
<td style="text-align: left;">Verify that all components are up to date with proper security configuration(s) and version(s). This should include removal of unneeded configurations and folders such as sample applications, platform documentation, and default or example users.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>19.2</strong></td>
<td style="text-align: left;">Verify that communications between components, such as between the application server and the database server, are encrypted, particularly when the components are in different containers or on different systems.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>19.3</strong></td>
<td style="text-align: left;">Verify that communications between components, such as between the application server and the database server, is authenticated using an account with the least necessary privileges.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>19.4</strong></td>
<td style="text-align: left;">Verify application deployments are adequately sandboxed, containerized or isolated to delay and deter attackers from attacking other applications.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>19.5</strong></td>
<td style="text-align: left;">Verify that the application build and deployment processes are performed in a secure and repeatable method, such as CI / CD automation and automated configuration management.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>19.6</strong></td>
<td style="text-align: left;">Verify that authorized administrators have the capability to verify the integrity of all security-relevant configurations to detect tampering.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>19.7</strong></td>
<td style="text-align: left;">Verify that all application components are signed.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>19.8</strong></td>
<td style="text-align: left;">Verify that third party components come from trusted repositories.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>19.9</strong></td>
<td style="text-align: left;">Verify that build processes for system level languages have all security flags enabled, such as ASLR, DEP, and security checks.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>19.10</strong></td>
<td style="text-align: left;">Verify that if application assets, such as JavaScript libraries, CSS stylesheets or web fonts, are hosted externally on a content delivery network (CDN) or external provider, sub-resource integrity (SRI) is used to validate the integrity of the asset.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>19.11</strong></td>
<td style="text-align: left;">Verify that all application components, services, and servers each use their own low privilege service account, that is not shared between applications nor used by administrators.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h2 id="references-15">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Testing_for_configuration_management">OWASP Testing Guide 4.0: Configuration and Deployment Management Testing</a></li>
</ul>
<h1 id="v20-internet-of-things-verification-requirements">V20: Internet of Things Verification Requirements</h1>
<p>This section contains controls that are Embedded/IoT device specific. These controls must be taken in conjunction with all other sections of the relevant ASVS Verification Level.</p>
<h2 id="control-objective-15">Control Objective</h2>
<p>Embedded/IoT devices should:</p>
<ul>
<li>Have the same level of security controls within the device as found in the server, by enforcing security controls in a trusted environment.</li>
<li>Sensitive data stored on the device should be done so in a secure manner using hardware backed storage such as secure elements.</li>
<li>All sensitive data transmitted from the device should utilize transport layer security.</li>
</ul>
<h2 id="security-verification-requirements-14">Security Verification Requirements</h2>
<table style="width:31%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">L1</th>
<th style="text-align: left;">L2</th>
<th style="text-align: left;">L3</th>
<th style="text-align: left;">Since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>20.1</strong></td>
<td style="text-align: left;">Verify that application layer debugging interfaces such USB, UART, and other serial variants are disabled or protected by a complex password.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.2</strong></td>
<td style="text-align: left;">Verify that cryptographic keys and certificats are unique to each individual device.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.3</strong></td>
<td style="text-align: left;">Verify that memory protection controls such as ASLR and DEP are enabled by the embedded/IoT operating system, if applicable.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.4</strong></td>
<td style="text-align: left;">Verify that on-chip debugging interfaces such as JTAG or SWD are disabled or that available protection mechanism is enabled and configured appropriately.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.5</strong></td>
<td style="text-align: left;">Verify that physical debug headers are not present on the device.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.6</strong></td>
<td style="text-align: left;">Verify that sensitive data is not stored unencrypted on the device.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.7</strong></td>
<td style="text-align: left;">Verify that ARM based processors make use of TrustZone and TEE (Trusted Execution Environment)</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.8</strong></td>
<td style="text-align: left;">Verify that private keys and certificates are stored securely in a Secure Element, TPM, TEE (Trusted Execution Environment), or protected using strong cryptography.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.9</strong></td>
<td style="text-align: left;">Verify that the firmware apps protect data-in-transit using transport layer security.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.10</strong></td>
<td style="text-align: left;">Verify that the firmware apps validate the digital signature of server connections.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.11</strong></td>
<td style="text-align: left;">Verify that wireless communications are mutually authenticated.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.12</strong></td>
<td style="text-align: left;">Verify that wireless communications are sent over an encrypted channel.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.13</strong></td>
<td style="text-align: left;">Verify that any use of banned C functions are replaced with the appropriate safe equivalent functions.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.14</strong></td>
<td style="text-align: left;">Verify that each firmware maintains a software bill of materials cataloging third-party components, versioning, and published vulnerabilities.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.15</strong></td>
<td style="text-align: left;">Verify all code including third-party binaries, libraries, frameworks are reviewed for hardcoded credentials (backdoors).</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.16</strong></td>
<td style="text-align: left;">Verify that the application and firmware components are not susceptible to OS Command Injection by invoking shell command wrappers, scripts, or that security controls prevent OS Command Injection.</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.17</strong></td>
<td style="text-align: left;">Verify that the firmware apps pin the digital signature to a trusted server(s).</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.18</strong></td>
<td style="text-align: left;">Verify the presence of physical tamper resistance and/or tamper detection features, including epoxy.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.19</strong></td>
<td style="text-align: left;">Verify that identifying markings on chips have been removed.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.20</strong></td>
<td style="text-align: left;">Verify that any available Intellectual Property protection technologies provided by the chip manufacturer are enabled.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.21</strong></td>
<td style="text-align: left;">Verify security controls are in place to hinder firmware reverse engineering (e.g., removal of verbose debugging symbols).</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.22</strong></td>
<td style="text-align: left;">Verify the device validates the boot image signature before loading.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.23</strong></td>
<td style="text-align: left;">Verify that the firmware update process is not vulnerable to time-of-check vs time-of-use attacks.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.24</strong></td>
<td style="text-align: left;">Verify the device uses code signing and validates firmware upgrade files before installing.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.25</strong></td>
<td style="text-align: left;">Verify that the device cannot be downgraded to old versions (anti-rollback) of valid firmware.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.26</strong></td>
<td style="text-align: left;">Verify usage of cryptographically secure pseudo-random number generator on embedded device (e.g., using chip-provided random number generators).</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.27</strong></td>
<td style="text-align: left;">Verify that firmware has the abilityto perform automatic firmware updates upon a predefined schedule.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.28</strong></td>
<td style="text-align: left;">Verify that the device wipes firmware and sensitive data upon detection of tampering or receipt of invalid message.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.29</strong></td>
<td style="text-align: left;">Verify that only micro controllers that support disabling debugging interfaces (e.g. JTAG, SWD) are used.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.30</strong></td>
<td style="text-align: left;">Verify that only micro controllers that provide substantial protection from de-capping and side channel attacks are used.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.31</strong></td>
<td style="text-align: left;">Verify that sensitive traces are not exposed to outer layers of the printed circuit board.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.32</strong></td>
<td style="text-align: left;">Verify that inter-chip communication is encrypted (e.g. Main board to daughter board commnucation).</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.33</strong></td>
<td style="text-align: left;">Verify the device uses code signing and validates code before execution.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.34</strong></td>
<td style="text-align: left;">Verify that sensitive information maintained in memory is overwritten with zeros as soon as it is no longer required.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.35</strong></td>
<td style="text-align: left;">Verify that the firmware apps utilize kernel containers for isolation between apps.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>20.36</strong></td>
<td style="text-align: left;">Verify that secure compiler flags such as -fPIE, -fstack-protector-all, -Wl,-z,noexecstack, -Wl,-z,noexecheap are configured for firmware builds.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>20.37</strong></td>
<td style="text-align: left;">Verify that micro controllers are configured with code protection (if applicable).</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">✓</td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<h2 id="references-16">References</h2>
<p>For more information, see also:</p>
<ul>
<li><a href="https://www.owasp.org/images/7/71/Internet_of_Things_Top_Ten_2014-OWASP.pdf">OWASP Internet of Things Top 10</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Embedded_Application_Security">OWASP Embedded Application Security Project</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Internet_of_Things_Project">OWASP Internet of Things Project</a></li>
<li><a href="https://github.com/praetorian-inc/trudy">Trudy TCP Proxy Tool</a></li>
</ul>
<h1 id="appendix-a-glossary">Appendix A: Glossary</h1>
<ul>
<li><strong>2FA</strong> – Two-factor authentication(2FA) adds a second level of authentication to an account log-in.</li>
<li><strong>Address Space Layout Randomization (ASLR)</strong> – A technique to make exploiting memory corruption bugs more difficult.</li>
<li><strong>Application Security</strong> – Application-level security focuses on the analysis of components that comprise the application layer of the Open Systems Interconnection Reference Model (OSI Model), rather than focusing on for example the underlying operating system or connected networks.</li>
<li><strong>Application Security Verification</strong> – The technical assessment of an application against the OWASP MASVS.</li>
<li><strong>Application Security Verification Report</strong> – A report that documents the overall results and supporting analysis produced by the verifier for a particular application.</li>
<li><strong>Authentication</strong> – The verification of the claimed identity of an application user.</li>
<li><strong>Automated Verification</strong> – The use of automated tools (either dynamic analysis tools, static analysis tools, or both) that use vulnerability signatures to find problems.</li>
<li><strong>Black box testing</strong> – It is a method of software testing that examines the functionality of an application without peering into its internal structures or workings.</li>
<li><strong>Component</strong> – a self-contained unit of code, with associated disk and network interfaces that communicates with other components.</li>
<li><strong>Cross-Site Scripting</strong> (XSS) – A security vulnerability typically found in web applications allowing the injection of client-side scripts into content.</li>
<li><strong>Cryptographic module</strong> – Hardware, software, and/or firmware that implements cryptographic algorithms and/or generates cryptographic keys.</li>
<li><strong>CWE</strong> - CWE is a community-developed list of common software security weaknesses. It serves as a common language, a measuring stick for software security tools, and as a baseline for weakness identification, mitigation, and prevention efforts.</li>
<li><strong>DAST</strong> –Dynamic application security testing (DAST) technologies are designed to detect conditions indicative of a security vulnerability in an application in its running state.</li>
<li><strong>Design Verification</strong> – The technical assessment of the security architecture of an application.</li>
<li><strong>Dynamic Verification</strong> – The use of automated tools that use vulnerability signatures to find problems during the execution of an application.</li>
<li><strong>Globally Unique Identifier</strong> (GUID) – a unique reference number used as an identifier in software.</li>
<li><strong>Hyper Text Transfer Protocol</strong> (HTTPS) – An application protocol for distributed, collaborative, hypermedia information systems. It is the foundation of data communication for the World Wide Web.</li>
<li><strong>Hardcoded keys</strong> – Cryptographic keys which are stored on the filesystem, be it in code, comments or files.</li>
<li><strong>IPC</strong> – Inter Process Communications,In IPC Processes communicate with each other and with the kernel to coordinate their activities.</li>
<li><strong>Input Validation</strong> – The canonicalization and validation of untrusted user input.</li>
<li><strong>JAVA Bytecode</strong> - Java bytecode is the instruction set of the Java virtual machine(JVM). Each bytecode is composed of one, or in some cases two bytes that represent the instruction (opcode), along with zero or more bytes for passing parameters.</li>
<li><strong>Malicious Code</strong> – Code introduced into an application during its development unbeknownst to the application owner, which circumvents the application's intended security policy. Not the same as malware such as a virus or worm!</li>
<li><strong>Malware</strong> – Executable code that is introduced into an application during runtime without the knowledge of the application user or administrator.</li>
<li><strong>Open Web Application Security Project</strong> (OWASP) – The Open Web Application Security Project (OWASP) is a worldwide free and open community focused on improving the security of application software. Our mission is to make application security &quot;visible,&quot; so that people and organizations can make informed decisions about application security risks. See: <a href="http://www.owasp.org/" class="uri">http://www.owasp.org/</a></li>
<li><strong>Personally Identifiable Information</strong> (PII) - is information that can be used on its own or with other information to identify, contact, or locate a single person, or to identify an individual in context.</li>
<li><strong>PIE</strong> – Position-independent executable (PIE) is a body of machine code that, being placed somewhere in the primary memory, executes properly regardless of its absolute address.</li>
<li><strong>PKI</strong> – A PKI is an arrangement that binds public keys with respective identities of entities. The binding is established through a process of registration and issuance of certificates at and by a certificate authority (CA).</li>
<li><strong>SAST</strong> – Static application security testing (SAST) is a set of technologies designed to analyze application source code, byte code and binaries for coding and design conditions that are indicative of security vulnerabilities. SAST solutions analyze an application from the “inside out” in a nonrunning state.</li>
<li><strong>SDLC</strong> – Software development lifecycle.</li>
<li><strong>Security Architecture</strong> – An abstraction of an application's design that identifies and describes where and how security controls are used, and also identifies and describes the location and sensitivity of both user and application data.</li>
<li><strong>Security Configuration</strong> – The runtime configuration of an application that affects how security controls are used.</li>
<li><strong>Security Control</strong> – A function or component that performs a security check (e.g. an access control check) or when called results in a security effect (e.g. generating an audit record).</li>
<li><strong>SQL Injection (SQLi)</strong> – A code injection technique used to attack data driven applications, in which malicious SQL statements are inserted into an entry point.</li>
<li><strong>SSO Authentication</strong> – Single Sign On(SSO) occurs when a user logs into one application and is then automatically logged into other applications without having to re-authenticate. For example when you log in in Google, you automatically login in the youtube , docs and mail service.</li>
<li><strong>Threat Modeling</strong> - A technique consisting of developing increasingly refined security architectures to identify threat agents, security zones, security controls, and important technical and business assets.</li>
<li><strong>Transport Layer Security</strong> – Cryptographic protocols that provide communication security over the Internet</li>
<li><strong>URI/URL/URL fragments</strong> – A Uniform Resource Identifier is a string of characters used to identify a name or a web resource. A Uniform Resource Locator is often used as a reference to a resource.</li>
<li><strong>User acceptance testing (UAT)</strong>– Traditionally a test environment that behaves like the production environment where all software testing is performed before going live.</li>
<li><strong>Verifier</strong> – The person or team that is reviewing an application against the OWASP ASVS requirements.</li>
<li><strong>Whitelist</strong> – A list of permitted data or operations, for example a list of characters that are allowed to perform input validation.</li>
<li><strong>X.509 Certificate</strong> – An X.509 certificate is a digital certificate that uses the widely accepted international X.509 public key infrastructure (PKI) standard to verify that a public key belongs to the user, computer or service identity contained within the certificate.</li>
</ul>
<h1 id="appendix-b-references">Appendix B: References</h1>
<p>The following OWASP projects are most likely to be useful to users/adopters of this standard:</p>
<ul>
<li>OWASP Mobile Security Project - <a href="https://www.owasp.org/index.php/OWASP_Mobile_Security_Project" class="uri">https://www.owasp.org/index.php/OWASP_Mobile_Security_Project</a></li>
<li>OWASP Mobile Security Testing Guide - <a href="https://www.owasp.org/index.php/OWASP_Mobile_Security_Testing_Guide" class="uri">https://www.owasp.org/index.php/OWASP_Mobile_Security_Testing_Guide</a></li>
<li>OWASP Mobile Top 10 Risks - <a href="https://www.owasp.org/index.php/Projects/OWASP_Mobile_Security_Project_-_Top_Ten_Mobile_Risks" class="uri">https://www.owasp.org/index.php/Projects/OWASP_Mobile_Security_Project_-_Top_Ten_Mobile_Risks</a></li>
<li>OWASP Reverse Engineering and Code Modification Prevention - <a href="https://www.owasp.org/index.php/OWASP_Reverse_Engineering_and_Code_Modification_Prevention_Project" class="uri">https://www.owasp.org/index.php/OWASP_Reverse_Engineering_and_Code_Modification_Prevention_Project</a></li>
</ul>
<p>Similarly, the following web sites are most likely to be useful to users/adopters of this standard:</p>
<ul>
<li>MITRE Common Weakness Enumeration - <a href="http://cwe.mitre.org/" class="uri">http://cwe.mitre.org/</a></li>
<li>PCI Security Standards Council - <a href="https://www.pcisecuritystandards.org" class="uri">https://www.pcisecuritystandards.org</a></li>
<li>PCI Data Security Standard (DSS) v3.0 Requirements and Security Assessment Procedures <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf" class="uri">https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf</a></li>
</ul>
</body>
</html>
